# Preparaci√≥n de un sitio para su lanzamiento

¬°Guauu! ¬°Has recorrido un largo camino! Ha aprendido a:

- crear nuevos sitios de Gatsby
- crear p√°ginas y componentes
- componentes de estilo
- agregar complementos a un sitio
- fuente y transformaci√≥n de datos
- usar GraphQL para consultar datos de p√°ginas
- crear p√°ginas de forma program√°tica a partir de sus datos

En esta secci√≥n final, analizar√° algunos pasos comunes para preparar un sitio para que se publique al presentar una poderosa herramienta de diagn√≥stico de sitios llamada [Lighthouse](https://developers.google.com/web/tools/lighthouse/). En el camino, presentaremos algunos complementos m√°s que a menudo querr√° usar en sus sitios de Gatsby.

## Auditor√≠a con Lighthouse

Citando del [sitio web de Lighthouse](https://developers.google.com/web/tools/lighthouse/):

> Lighthouse es una herramienta automatizada de c√≥digo abierto para mejorar la calidad de las p√°ginas web. Puede ejecutarlo en cualquier p√°gina web, p√∫blica o que requiera autenticaci√≥n. Tiene auditor√≠as de rendimiento, accesibilidad, aplicaciones web progresivas (PWA) y m√°s.

Lighthouse est√° incluido en Chrome DevTools. Ejecutar su auditor√≠a, y luego abordar los errores que encuentra e implementar las mejoras que sugiere, es una excelente manera de preparar su sitio para que entre en funcionamiento. Le ayuda a tener la confianza de que su sitio es lo m√°s r√°pido y accesible posible.

¬°Pru√©balo!

Primero, debe crear una compilaci√≥n de producci√≥n de su sitio de Gatsby. El servidor de desarrollo de Gatsby est√° optimizado para acelerar el desarrollo; Pero el sitio que genera, aunque se parece mucho a una versi√≥n de producci√≥n del sitio, no est√° tan optimizado.

## ‚úã Cree una construcci√≥n de producci√≥n

1. Detenga el servidor de desarrollo (si a√∫n se est√° ejecutando) y ejecute el siguiente comando:

```shell
gatsby build
```

> üí° Como aprendi√≥ en la [parte 1](), esto hace una compilaci√≥n de producci√≥n de su sitio y genera los archivos est√°ticos compilados en el directorio `public`.

2. Ver el sitio de producci√≥n localmente. Ejecutar:

```shell
gatsby serve
```

Una vez que esto comience, puede ver su sitio en `http://localhost:9000`.

### Ejecutar una auditor√≠a de Lighthouse

Ahora vas a realizar tu primera prueba de Lighthouse.

1. Si a√∫n no lo ha hecho, abra el sitio en el modo inc√≥gnito de Chrome para que ninguna extensi√≥n interfiera con la prueba. Luego, abra Chrome DevTools.

2. Haga clic en la pesta√±a "Auditor√≠as" donde ver√° una pantalla que se parece a:

![](https://www.gatsbyjs.com/static/cdc985b7497f4a6b99b6bbd19f9168fa/321ea/lighthouse-audit.png)

3. Haga clic en "Realizar una auditor√≠a ..." (Todos los tipos de auditor√≠a disponibles deben seleccionarse de forma predeterminada). Luego haga clic en "Ejecutar auditor√≠a". (Luego, tomar√° aproximadamente un minuto ejecutar la auditor√≠a). Una vez que se completa la auditor√≠a, deber√≠a ver resultados que se ven as√≠:

![](https://www.gatsbyjs.com/static/46b36f48f05e2a3ce358991fe95c5446/321ea/lighthouse-audit-results.png)

algunas cosas para PWA, accesibilidad, mejores pr√°cticas y SEO que mejorar√°n sus puntajes (y en el proceso har√°n que su sitio sea mucho m√°s amigable para los visitantes y los motores de b√∫squeda).

## Agregar un archivo de manifiesto

Parece que tiene una puntuaci√≥n bastante mediocre en la categor√≠a "Aplicaci√≥n web progresiva". Abordemos eso.

Pero primero, ¬øqu√© _son_ exactamente las PWA?

Son sitios web regulares que aprovechan la funcionalidad del navegador moderno para aumentar la experiencia web con caracter√≠sticas y beneficios similares a las de una aplicaci√≥n. Consulte la [descripci√≥n general de Google](https://developers.google.com/web/progressive-web-apps/) sobre lo que define una experiencia de PWA.

La inclusi√≥n de un manifiesto de aplicaci√≥n web es uno de los tres [requisitos b√°sicos](https://alistapart.com/article/yes-that-web-project-should-be-a-pwa#section1) generalmente aceptados para una PWA.

Citando a [Google](https://developers.google.com/web/fundamentals/web-app-manifest/):

> El manifiesto de la aplicaci√≥n web es un archivo JSON simple que le informa al navegador sobre su aplicaci√≥n web y c√≥mo debe comportarse cuando est√° "instalada" en el dispositivo m√≥vil o el escritorio del usuario.

El [complemento de manifiesto de Gatsby](https://www.gatsbyjs.com/packages/gatsby-plugin-manifest/) configura a Gatsby para crear un archivo `manifest.webmanifest` en cada construcci√≥n del sitio.

## ‚úã Usando `gatsby-plugin-manifest`

1. Instale el complemento:

```shell
npm install gatsby-plugin-manifest
```

2. Agrega un favicon para tu aplicaci√≥n en `src/images/icon.png`. Para los prop√≥sitos de este tutorial, puede usar [este icono de ejemplo](https://raw.githubusercontent.com/gatsbyjs/gatsby/master/docs/tutorial/part-eight/icon.png), en caso de que no tenga uno disponible. El icono es necesario para crear todas las im√°genes del manifiesto. Para obtener m√°s informaci√≥n, consulte los documentos de `[gatsby-plugin-manifest](https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-plugin-manifest/README.md)`.

3. Agregue el complemento a la matriz de `complementos` en su archivo `gatsby-config.js`.

```javascript
// gatsby-config.js

{
  plugins: [
    {
      resolve: `gatsby-plugin-manifest`,
      options: {
        name: `GatsbyJS`,
        short_name: `GatsbyJS`,
        start_url: `/`,
        background_color: `#6b37bf`,
        theme_color: `#6b37bf`,
        // Enables "Add to Homescreen" prompt and disables browser UI (including back button)
        // see https://developers.google.com/web/fundamentals/web-app-manifest/#display
        display: `standalone`,
        icon: `src/images/icon.png`, // This path is relative to the root of the site.
      },
    },
  ];
}
```

Eso es todo lo que necesita para comenzar a agregar un manifiesto web a un sitio de Gatsby. El ejemplo dado refleja una configuraci√≥n b√°sica: consulte la [referencia del complemento](https://www.gatsbyjs.com/packages/gatsby-plugin-manifest/?=gatsby-plugin-manifest#automatic-mode) para obtener m√°s opciones.

## Agregar soporte sin conexi√≥n

Otro requisito para que un sitio web califique como PWA es el uso de un [trabajador de servicios](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API). Un trabajador de servicios se ejecuta en segundo plano y decide entregar contenido en cach√© o de red en funci√≥n de la conectividad, lo que permite una experiencia sin conexi√≥n administrada y sin problemas.

El [complemento sin conexi√≥n de Gatsby](https://www.gatsbyjs.com/packages/gatsby-plugin-offline/) hace que un sitio de Gatsby funcione sin conexi√≥n y sea m√°s resistente a las malas condiciones de la red al crear un trabajador de servicio para su sitio.

## ‚úã Usando gatsby-plugin-offline

1. Instale el complemento:

```shell
npm install gatsby-plugin-offline
```

2. Agregue el complemento a la matriz de `complementos` en su archivo `gatsby-config.js`.

```javascript
// gatsby-config.js

{
  plugins: [
    {
      resolve: `gatsby-plugin-manifest`,
      options: {
        name: `GatsbyJS`,
        short_name: `GatsbyJS`,
        start_url: `/`,
        background_color: `#6b37bf`,
        theme_color: `#6b37bf`,
        // Enables "Add to Homescreen" prompt and disables browser UI (including back button)
        // see https://developers.google.com/web/fundamentals/web-app-manifest/#display
        display: `standalone`,
        icon: `src/images/icon.png`, // This path is relative to the root of the site.
      },
    },
    `gatsby-plugin-offline`,
  ];
}
```

Eso es todo lo que necesita para comenzar a trabajar con los trabajadores de servicios con Gatsby.

> üí° El complemento sin conexi√≥n debe aparecer despu√©s del complemento de manifiesto para que el complemento sin conexi√≥n pueda almacenar en cach√© el manifest.webmanifest creado.

## Agregar metadatos de p√°gina

Agregar metadatos a las p√°ginas (como un t√≠tulo o una descripci√≥n) es clave para ayudar a los motores de b√∫squeda como Google a comprender su contenido y decidir cu√°ndo mostrarlo en los resultados de b√∫squeda.

[React Helmet](https://github.com/nfl/react-helmet) es un paquete que proporciona una interfaz de componente React para que pueda administrar el [encabezado de su documento](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/head).

El [complemento react helmet](https://www.gatsbyjs.com/packages/gatsby-plugin-react-helmet/) de Gatsby proporciona soporte directo para los datos de renderizaci√≥n del servidor agregados con React Helmet. Usando el complemento, los atributos que agregue a React Helmet se agregar√°n a las p√°ginas HTML est√°ticas que construye Gatsby.

### ‚úã Usando React Helmet y gatsby-plugin-react-helmet

1. Instale ambos paquetes:

```shell
npm install gatsby-plugin-react-helmet react-helmet
```

2. Aseg√∫rese de tener una `descripci√≥n` y un `autor` configurados dentro de su objeto `siteMetadata`. Adem√°s, agregue el complemento `gatsby-plugin-react-helmet` a la matriz de `complementos` en su archivo `gatsby-config.js`.

```javascript
// gatsby-config.js

module.exports = {
  siteMetadata: {
    title: `Pandas Eating Lots`,
    description: `A simple description about pandas eating lots...`,
    author: `gatsbyjs`,
  },
  plugins: [
    {
      resolve: `gatsby-plugin-manifest`,
      options: {
        name: `GatsbyJS`,
        short_name: `GatsbyJS`,
        start_url: `/`,
        background_color: `#6b37bf`,
        theme_color: `#6b37bf`,
        // Enables "Add to Homescreen" prompt and disables browser UI (including back button)
        // see https://developers.google.com/web/fundamentals/web-app-manifest/#display
        display: `standalone`,
        icon: `src/images/icon.png`, // This path is relative to the root of the site.
      },
    },
    `gatsby-plugin-offline`,
    `gatsby-plugin-react-helmet`,
  ],
};
```

3. En el directorio `src/components`, cree un archivo llamado `seo.js` y agregue lo siguiente:

```jsx
// src/components/seo.js

import React from "react";
import PropTypes from "prop-types";
import { Helmet } from "react-helmet";
import { useStaticQuery, graphql } from "gatsby";

function SEO({ description, lang, meta, title }) {
  const { site } = useStaticQuery(
    graphql`
      query {
        site {
          siteMetadata {
            title
            description
            author
          }
        }
      }
    `
  );

  const metaDescription = description || site.siteMetadata.description;

  return (
    <Helmet
      htmlAttributes={{
        lang,
      }}
      title={title}
      titleTemplate={`%s | ${site.siteMetadata.title}`}
      meta={[
        {
          name: `description`,
          content: metaDescription,
        },
        {
          property: `og:title`,
          content: title,
        },
        {
          property: `og:description`,
          content: metaDescription,
        },
        {
          property: `og:type`,
          content: `website`,
        },
        {
          name: `twitter:card`,
          content: `summary`,
        },
        {
          name: `twitter:creator`,
          content: site.siteMetadata.author,
        },
        {
          name: `twitter:title`,
          content: title,
        },
        {
          name: `twitter:description`,
          content: metaDescription,
        },
      ].concat(meta)}
    />
  );
}

SEO.defaultProps = {
  lang: `en`,
  meta: [],
  description: ``,
};

SEO.propTypes = {
  description: PropTypes.string,
  lang: PropTypes.string,
  meta: PropTypes.arrayOf(PropTypes.object),
  title: PropTypes.string.isRequired,
};

export default SEO;
```

El c√≥digo anterior establece valores predeterminados para sus etiquetas de metadatos m√°s comunes y le proporciona un componente `<SEO>` para trabajar con el resto de su proyecto. Bastante bien, ¬øverdad?

4. Ahora, puede usar el componente `<SEO>` en sus plantillas y p√°ginas y pasarle accesorios. Por ejemplo, agr√©guelo a su plantilla `blog-post.js` as√≠:

```jsx
// src/templates/blog-post.js

import React from "react";
import { graphql } from "gatsby";
import Layout from "../components/layout";
import SEO from "../components/seo";

export default function BlogPost({ data }) {
  const post = data.markdownRemark;
  return (
    <Layout>
      <SEO title={post.frontmatter.title} description={post.excerpt} />
      <div>
        <h1>{post.frontmatter.title}</h1>
        <div dangerouslySetInnerHTML={{ __html: post.html }} />
      </div>
    </Layout>
  );
}

export const query = graphql`
  query($slug: String!) {
    markdownRemark(fields: { slug: { eq: $slug } }) {
      html
      frontmatter {
        title
      }
      excerpt
    }
  }
`;
```

El ejemplo anterior se basa en el [Blog de inicio de Gatsby](https://www.gatsbyjs.com/starters/gatsbyjs/gatsby-starter-blog/). Al pasar accesorios al componente `<SEO>`, puede cambiar din√°micamente los metadatos de una publicaci√≥n. En este caso, el `title` y el `excerpt` de la publicaci√≥n del blog (si existe en el archivo de markdown de la publicaci√≥n del blog) se usar√°n en lugar de las propiedades predeterminadas de `siteMetadata` en su archivo `gatsby-config.js`.

Ahora, si vuelve a ejecutar la auditor√≠a de Lighthouse como se describe anteriormente, deber√≠a acercarse a, si no un puntaje perfecto, 100.

> üí° Para obtener m√°s informaci√≥n y ejemplos, consulte [Agregar un componente SEO](https://www.gatsbyjs.com/docs/add-seo-component/) y los [documentos de React Helmet](https://github.com/nfl/react-helmet#example).

## Sigue haci√©ndolo mejor

En esta secci√≥n, le mostramos algunas herramientas espec√≠ficas de Gatsby para mejorar el rendimiento de su sitio y prepararse para su lanzamiento.

Lighthouse es una gran herramienta para mejorar el sitio y aprender. Contin√∫e revisando los comentarios detallados que proporciona y siga mejorando su sitio.

## Pr√≥ximos pasos

### Documentaci√≥n oficial

- [Documentaci√≥n oficial](https://www.gatsbyjs.com/docs/): vea nuestra documentaci√≥n oficial para obtener un [inicio r√°pido](https://www.gatsbyjs.com/docs/quick-start/), [gu√≠as detalladas](https://www.gatsbyjs.com/docs/preparing-your-environment/), [referencias de API](https://www.gatsbyjs.com/docs/gatsby-link/) y mucho m√°s.

### Complementos oficiales

- [Complementos oficiales](https://github.com/gatsbyjs/gatsby/tree/master/packages): la lista completa de todos los complementos oficiales mantenidos por Gatsby.

### Arrancadores Oficiales

1. [Iniciador predeterminado de Gatsby](https://github.com/gatsbyjs/gatsby-starter-default): Comience su proyecto con este texto est√°ndar predeterminado. Este iniciador b√°sico se env√≠a con los principales archivos de configuraci√≥n de Gatsby que pueda necesitar. [ejemplo de trabajo](https://gatsbyjs.github.io/gatsby-starter-default/)
2. [Inicio del blog de Gatsby](https://github.com/gatsbyjs/gatsby-starter-blog): Iniciador de Gatsby para crear un blog incre√≠ble y ultrarr√°pido. [ejemplo de trabajo](https://gatsbyjs.github.io/gatsby-starter-blog/)
3. [Hello-World Starter de Gatsby](https://github.com/gatsbyjs/gatsby-starter-hello-world): Gatsby Starter con los elementos b√°sicos necesarios para un sitio de Gatsby. [ejemplo de trabajo](https://gatsby-starter-hello-world-demo.netlify.app/)

### Eso es todo amigos

Bueno, no del todo; solo para este tutorial. Hay [tutoriales adicionales](https://www.gatsbyjs.com/tutorial/additional-tutorials/) que puede consultar para obtener m√°s casos de uso guiados.

Este es solo el comienzo. ¬°Sigue adelante!

- ¬øConstruiste algo genial? ¬°Comp√°rtelo en Twitter, etiqueta [#buildwithgatsby](https://twitter.com/search?q=%23buildwithgatsby) y [@menci√≥nanos](https://twitter.com/gatsbyjs)!
- ¬øEscribiste una publicaci√≥n de blog interesante sobre lo que aprendiste? ¬°Comparte eso tambi√©n!
- ¬°Contribuir! D√© un paseo por los [problemas abiertos](https://github.com/gatsbyjs/gatsby/issues?q=is%3Aissue+is%3Aopen+label%3A%22help+wanted%22) en el repositorio de gatsby y [convi√©rtase en colaborador](https://www.gatsbyjs.com/contributing/how-to-contribute/).

Consulte los documentos ["c√≥mo contribuir"](https://www.gatsbyjs.com/contributing/how-to-contribute/) para obtener a√∫n m√°s ideas.

No podemos esperar a ver lo que haces üòÑ.
